# Cloudflare Workers configuration for Gremlin API

name = "gremlin-api"
main = "src/index.ts"
compatibility_date = "2024-11-01"

# Account ID - set via environment variable or CLI
# account_id = ""

# Workers configuration
workers_dev = true

# R2 bucket binding for session storage
[[r2_buckets]]
binding = "SESSIONS"
bucket_name = "gremlin-sessions"
preview_bucket_name = "gremlin-sessions-preview"

# Environment variables
[vars]
# Non-secret environment variables go here

# Secrets (set via: wrangler secret put API_KEY)
# API_KEY - Required for authentication
# Set with: wrangler secret put API_KEY

# Development environment
[env.development]
name = "gremlin-api-dev"
workers_dev = true

[[env.development.r2_buckets]]
binding = "SESSIONS"
bucket_name = "gremlin-sessions-dev"

# Production environment
[env.production]
name = "gremlin-api"
workers_dev = false

[[env.production.r2_buckets]]
binding = "SESSIONS"
bucket_name = "gremlin-sessions"

# Build configuration
[build]
command = ""

[build.upload]
format = "modules"
main = "./src/index.ts"

# Limits
[limits]
# Increase if needed for large sessions
cpu_ms = 50

# Observability
[observability]
enabled = true
